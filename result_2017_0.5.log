20170103
Start Training:
First Optimization Finished!
Start Training:
Step 0   , Loss =    36476.066, Turn_over =   0.79, TE = 0.042, Industry_dev = 0.017, FE_BP = 0.427, FE_return = 0.435
Step 100 , Loss =       46.828, Turn_over =   0.50, TE = 0.037, Industry_dev = 0.015, FE_BP = 0.731, FE_return = 0.430
Step 200 , Loss =        9.157, Turn_over =   0.49, TE = 0.037, Industry_dev = 0.014, FE_BP = 0.729, FE_return = 0.430
Step 300 , Loss =      -31.662, Turn_over =   0.50, TE = 0.037, Industry_dev = 0.014, FE_BP = 0.728, FE_return = 0.430
Step 400 , Loss =      -72.228, Turn_over =   0.50, TE = 0.037, Industry_dev = 0.014, FE_BP = 0.728, FE_return = 0.429
Step 500 , Loss =     -107.750, Turn_over =   0.49, TE = 0.037, Industry_dev = 0.013, FE_BP = 0.726, FE_return = 0.429
Step 600 , Loss =     -145.991, Turn_over =   0.50, TE = 0.037, Industry_dev = 0.013, FE_BP = 0.726, FE_return = 0.429
Step 700 , Loss =     -180.579, Turn_over =   0.49, TE = 0.037, Industry_dev = 0.012, FE_BP = 0.724, FE_return = 0.429
Step 800 , Loss =     -219.145, Turn_over =   0.50, TE = 0.037, Industry_dev = 0.012, FE_BP = 0.723, FE_return = 0.429
Step 900 , Loss =     -254.002, Turn_over =   0.50, TE = 0.036, Industry_dev = 0.012, FE_BP = 0.722, FE_return = 0.428
Step 1000, Loss =     -283.045, Turn_over =   0.49, TE = 0.036, Industry_dev = 0.011, FE_BP = 0.721, FE_return = 0.428
Step 1100, Loss =     -315.466, Turn_over =   0.50, TE = 0.036, Industry_dev = 0.011, FE_BP = 0.720, FE_return = 0.428
Step 1200, Loss =     -343.234, Turn_over =   0.50, TE = 0.036, Industry_dev = 0.011, FE_BP = 0.719, FE_return = 0.428
Step 1300, Loss =     -369.043, Turn_over =   0.49, TE = 0.036, Industry_dev = 0.011, FE_BP = 0.718, FE_return = 0.428
Step 1400, Loss =     -403.157, Turn_over =   0.50, TE = 0.036, Industry_dev = 0.010, FE_BP = 0.717, FE_return = 0.428
Step 1500, Loss =     -427.666, Turn_over =   0.49, TE = 0.036, Industry_dev = 0.010, FE_BP = 0.716, FE_return = 0.428
Step 1600, Loss =     -428.231, Turn_over =   0.49, TE = 0.036, Industry_dev = 0.010, FE_BP = 0.716, FE_return = 0.428
Step 1700, Loss =     -428.795, Turn_over =   0.49, TE = 0.036, Industry_dev = 0.010, FE_BP = 0.716, FE_return = 0.429
Step 1800, Loss =     -429.348, Turn_over =   0.49, TE = 0.036, Industry_dev = 0.010, FE_BP = 0.716, FE_return = 0.429
Step 1900, Loss =     -429.912, Turn_over =   0.49, TE = 0.036, Industry_dev = 0.010, FE_BP = 0.716, FE_return = 0.430
           final_weight  initial_weight  industry        BP  return_1m
603528.SH      0.005387        0.005341      21.0 -0.677049   1.483753
600259.SH      0.009288        0.008453      11.0 -0.887746   2.046680
002238.SZ      0.008777        0.003578       5.0  0.174667  -0.038069
603568.SH      0.008599        0.004200      19.0 -0.592308   0.316151
000761.SZ      0.001981        0.002126      17.0  2.188171   0.361367
002642.SZ      0.006904        0.006741      21.0  0.116802   1.274052
601016.SH      0.009469        0.004823      19.0  0.521089   0.470753
002371.SZ      0.007084        0.006430       4.0  0.065605   1.091874
600874.SH      0.003982        0.004667      19.0  0.699342   0.342528
600864.SH      0.006663        0.004771      19.0 -0.424816   0.238752
000937.SZ      0.009224        0.009386      24.0  2.480221   1.512412
601699.SH      0.015609        0.012653      24.0  2.050116   1.352693
600497.SH      0.011899        0.015972      11.0  0.727802   0.830754
002551.SZ      0.009222        0.005808       2.0 -0.166155   0.488713
000681.SZ      0.009806        0.007052       5.0 -0.380072   0.831166
300043.SZ      0.007985        0.006638       3.0 -0.309926   0.726973
600549.SH      0.006578        0.012549      11.0  0.370422   1.266507
601002.SH      0.008347        0.005963      13.0  0.320040   0.470699
300253.SZ      0.009493        0.014675      21.0 -0.492243   0.594463
600801.SH      0.022647        0.004978       7.0  2.950739  -0.008071
600138.SH      0.008335        0.015972      -1.0  0.755458   0.549535
601886.SH      0.016465        0.006482      18.0  1.442046   0.517757
300324.SZ      0.004871        0.014624      21.0 -0.747681   0.500436
600503.SH      0.013170        0.017476       8.0  0.114647   0.597953
002029.SZ      0.015698        0.006067       9.0  1.739901   0.313089
600748.SH      0.008139        0.005963       8.0  0.458345   0.247532
300134.SZ      0.011513        0.012809       0.0  0.202642   0.912821
002038.SZ      0.012189        0.014468       2.0 -0.197532   0.434211
002273.SZ      0.008542        0.013898       4.0 -0.172550   0.506265
300026.SZ      0.010569        0.017216       2.0  0.427453   0.512532
...                 ...             ...       ...       ...        ...
000587.SZ      0.012685        0.008297       1.0  1.324177   0.520159
300273.SZ      0.013129        0.012394       2.0 -0.263451   0.682924
300032.SZ      0.008678        0.006897       4.0  0.429942   0.168880
002001.SZ      0.008492        0.014053       2.0  0.444476   0.167203
000931.SZ      0.005966        0.006015      -1.0 -0.317954  -0.092883
002242.SZ      0.006318        0.007312       6.0 -0.061104   0.248434
000596.SZ      0.005778        0.006897      16.0 -0.032610   0.142055
000598.SZ      0.013964        0.013586      -1.0  1.137547   0.248943
000975.SZ      0.009819        0.013379      11.0  0.065054   0.309561
603866.SH      0.010525        0.002593      16.0 -0.667945   0.016667
600872.SH      0.009532        0.010319      16.0  0.039939   0.711946
002013.SZ      0.007380        0.015453      -1.0  0.073055  -0.042421
600198.SH      0.010098        0.012912       0.0  0.036464   0.494444
600664.SH      0.008505        0.017216       2.0  0.484525   0.149938
600516.SH      0.011598        0.012549       7.0  0.532900   0.578220
002368.SZ      0.007420        0.008349      21.0 -0.362743   0.406442
603377.SH      0.012381        0.002697      10.0 -0.633576   0.110125
600601.SH      0.005038        0.013275      21.0  0.383918   0.311744
600312.SH      0.014761        0.013949      22.0  0.249049   0.022518
600826.SH      0.007494        0.007571       1.0  0.352908   0.238803
000959.SZ      0.020172        0.013846      17.0  2.993894  -0.105326
600862.SH      0.008695        0.006741      26.0 -0.229601   0.007761
000810.SZ      0.008686        0.009593       6.0 -0.328104   0.567055
300055.SZ      0.011896        0.013068      19.0  0.576207   0.320490
600981.SH      0.002531        0.002748       1.0  0.956690   0.194866
600879.SH      0.010374        0.017164      26.0  0.872869   0.026687
600639.SH      0.013194        0.008297       8.0  0.671512   0.358643
000581.SZ      0.016652        0.017320      10.0  1.340421   0.070738
600729.SH      0.011141        0.007519       1.0  1.025296   0.150032
002005.SZ      0.017519        0.007415       4.0  2.070000   0.150919

[100 rows x 5 columns]
This month excess return: 4.655029624700546e-05
20170207
Start Training:
First Optimization Finished!
Start Training:
Step 0   , Loss =    51463.594, Turn_over =   0.78, TE = 0.034, Industry_dev = 0.013, FE_BP = 0.264, FE_return = 0.359
Step 100 , Loss =     -103.622, Turn_over =   0.50, TE = 0.031, Industry_dev = 0.013, FE_BP = 0.582, FE_return = 0.372
Step 200 , Loss =     -144.104, Turn_over =   0.49, TE = 0.031, Industry_dev = 0.012, FE_BP = 0.579, FE_return = 0.373
Step 300 , Loss =     -187.497, Turn_over =   0.50, TE = 0.031, Industry_dev = 0.012, FE_BP = 0.576, FE_return = 0.373
Step 400 , Loss =     -228.455, Turn_over =   0.50, TE = 0.031, Industry_dev = 0.011, FE_BP = 0.573, FE_return = 0.374
Step 500 , Loss =     -263.054, Turn_over =   0.49, TE = 0.031, Industry_dev = 0.011, FE_BP = 0.570, FE_return = 0.374
Step 600 , Loss =     -300.144, Turn_over =   0.50, TE = 0.031, Industry_dev = 0.011, FE_BP = 0.567, FE_return = 0.375
Step 700 , Loss =     -333.508, Turn_over =   0.49, TE = 0.031, Industry_dev = 0.010, FE_BP = 0.565, FE_return = 0.375
Step 800 , Loss =     -370.649, Turn_over =   0.50, TE = 0.031, Industry_dev = 0.010, FE_BP = 0.562, FE_return = 0.376
Step 900 , Loss =     -376.395, Turn_over =   0.50, TE = 0.031, Industry_dev = 0.010, FE_BP = 0.561, FE_return = 0.376
Step 1000, Loss =     -377.052, Turn_over =   0.50, TE = 0.031, Industry_dev = 0.010, FE_BP = 0.561, FE_return = 0.377
Step 1100, Loss =     -377.709, Turn_over =   0.50, TE = 0.031, Industry_dev = 0.010, FE_BP = 0.561, FE_return = 0.378
Step 1200, Loss =     -378.366, Turn_over =   0.50, TE = 0.031, Industry_dev = 0.010, FE_BP = 0.561, FE_return = 0.378
Step 1300, Loss =     -379.023, Turn_over =   0.50, TE = 0.031, Industry_dev = 0.010, FE_BP = 0.561, FE_return = 0.379
Step 1400, Loss =     -379.681, Turn_over =   0.50, TE = 0.031, Industry_dev = 0.010, FE_BP = 0.560, FE_return = 0.380
Step 1500, Loss =     -380.338, Turn_over =   0.50, TE = 0.031, Industry_dev = 0.010, FE_BP = 0.560, FE_return = 0.380
Step 1600, Loss =     -380.996, Turn_over =   0.50, TE = 0.031, Industry_dev = 0.010, FE_BP = 0.560, FE_return = 0.381
Step 1700, Loss =     -381.654, Turn_over =   0.50, TE = 0.031, Industry_dev = 0.010, FE_BP = 0.560, FE_return = 0.382
Step 1800, Loss =     -382.311, Turn_over =   0.50, TE = 0.031, Industry_dev = 0.010, FE_BP = 0.560, FE_return = 0.382
Step 1900, Loss =     -382.969, Turn_over =   0.50, TE = 0.031, Industry_dev = 0.010, FE_BP = 0.559, FE_return = 0.383
           final_weight  initial_weight  industry        BP  return_1m
600917.SH      0.006240        0.002919      19.0 -0.261473   0.605106
000025.SZ      0.003605        0.003716      10.0 -0.873949   0.485714
002602.SZ      0.011712        0.013854       5.0 -0.605433   2.094217
002238.SZ      0.002859        0.003556       5.0  0.197640   0.052486
603005.SH      0.005332        0.004247       4.0  0.005446   0.516400
600088.SH      0.005150        0.003769       5.0 -0.399148   0.103755
002416.SZ      0.006895        0.005361       0.0  0.620508   0.988651
603025.SH      0.008398        0.002229      21.0 -0.687595   0.046718
000066.SZ      0.011631        0.024471      21.0  0.254211   1.709050
603369.SH      0.007739        0.006264      16.0  0.151069   0.857533
300202.SZ      0.007236        0.007272      21.0 -0.469371   1.108385
002315.SZ      0.007731        0.004777       5.0  0.099206   0.132806
002093.SZ      0.007218        0.005414       0.0 -0.540552   0.439628
000761.SZ      0.020824        0.002282      17.0  2.141533  -0.039720
000806.SZ      0.012986        0.011572      22.0 -0.480505   1.637884
600392.SH      0.010641        0.008812      11.0 -0.588706   1.323197
600397.SH      0.013909        0.004830      24.0  1.245067  -0.006655
600874.SH      0.011267        0.004830      19.0  0.689731  -0.069010
002642.SZ      0.008157        0.006211      21.0  0.212862   0.525036
002698.SZ      0.005627        0.005414      13.0 -0.342504   0.204290
300273.SZ      0.014058        0.012262       2.0 -0.252576   1.277770
002030.SZ      0.011621        0.014279       2.0 -0.529588   0.615621
002354.SZ      0.007622        0.007591       5.0  0.091113   0.871069
600971.SH      0.003457        0.004512      24.0  2.758036  -0.388973
600751.SH      0.015387        0.014120      14.0  1.169083   0.553120
600335.SH      0.004373        0.005202      10.0  1.307007  -0.023101
603555.SH      0.006354        0.005255       9.0 -0.607598  -0.018235
002176.SZ      0.012651        0.015500      13.0  0.140778   0.552876
601777.SH      0.015193        0.007484      10.0  1.589004   0.721865
002670.SZ      0.005761        0.005892       6.0  0.572854   0.250485
...                 ...             ...       ...       ...        ...
600158.SH      0.006437        0.021816       8.0 -0.740499   0.653725
600601.SH      0.006741        0.013430      21.0  0.402411   0.270272
002073.SZ      0.011279        0.009183      13.0  0.829452   0.579242
002011.SZ      0.006172        0.006954      13.0  1.133405   0.133279
002366.SZ      0.006886        0.018154      13.0 -0.751000   0.325053
002122.SZ      0.009574        0.009077      13.0  0.503680   0.579027
002681.SZ      0.007362        0.006529       4.0 -0.382153  -0.018235
600094.SH      0.011700        0.012633       8.0  1.276526   0.451522
000930.SZ      0.007990        0.017145      20.0 -0.569534   0.254392
300026.SZ      0.009344        0.017305       2.0  0.458929   0.171954
002657.SZ      0.010105        0.010457      21.0 -0.210449   0.767405
002311.SZ      0.011100        0.015447      20.0 -0.038512  -0.006354
600651.SH      0.009342        0.008918       6.0  0.433521   0.504686
002405.SZ      0.007249        0.021498      21.0 -0.453650   0.508070
600549.SH      0.013973        0.012793      11.0  0.404239   0.394231
002665.SZ      0.011886        0.013854      22.0 -0.356930  -0.011383
600831.SH      0.008677        0.006423       5.0  0.418033  -0.095093
000400.SZ      0.015043        0.014916      22.0  0.525786  -0.090283
002479.SZ      0.008133        0.008068      19.0  0.255750   0.362454
600811.SH      0.023811        0.013854       1.0  3.011414  -0.075752
603377.SH      0.007215        0.002760      10.0 -0.645751  -0.021309
000566.SZ      0.007851        0.014544       2.0  0.255031  -0.213592
002001.SZ      0.009137        0.013854       2.0  0.490067  -0.040110
000598.SZ      0.013572        0.013642      -1.0  1.197799   0.076394
600161.SH      0.010860        0.013748       2.0 -0.624329  -0.018235
000690.SZ      0.014600        0.016402      19.0  0.624248   0.000990
600884.SH      0.010903        0.009608       4.0  1.479779   0.597729
600633.SH      0.011722        0.012315       5.0 -0.067944   0.455244
300291.SZ      0.008056        0.008652       5.0  0.554915   0.379615
600528.SH      0.009747        0.013642      18.0 -0.058878   0.081425

[100 rows x 5 columns]
This month excess return: -0.00047124014236032963
20170307
Start Training:
First Optimization Finished!
Start Training:
Step 0   , Loss =    14377.655, Turn_over =   0.64, TE = 0.027, Industry_dev = 0.017, FE_BP = 0.634, FE_return = 0.351
Step 100 , Loss =     -161.429, Turn_over =   0.50, TE = 0.025, Industry_dev = 0.012, FE_BP = 0.612, FE_return = 0.351
Step 200 , Loss =     -228.401, Turn_over =   0.49, TE = 0.025, Industry_dev = 0.011, FE_BP = 0.616, FE_return = 0.351
Step 300 , Loss =     -292.794, Turn_over =   0.49, TE = 0.025, Industry_dev = 0.011, FE_BP = 0.619, FE_return = 0.351
Step 400 , Loss =     -350.914, Turn_over =   0.50, TE = 0.025, Industry_dev = 0.010, FE_BP = 0.620, FE_return = 0.351
Step 500 , Loss =     -351.830, Turn_over =   0.50, TE = 0.025, Industry_dev = 0.010, FE_BP = 0.620, FE_return = 0.352
Step 600 , Loss =     -352.745, Turn_over =   0.50, TE = 0.026, Industry_dev = 0.010, FE_BP = 0.620, FE_return = 0.353
Step 700 , Loss =     -353.661, Turn_over =   0.50, TE = 0.026, Industry_dev = 0.010, FE_BP = 0.620, FE_return = 0.354
Step 800 , Loss =     -354.577, Turn_over =   0.50, TE = 0.026, Industry_dev = 0.010, FE_BP = 0.620, FE_return = 0.355
Step 900 , Loss =     -355.494, Turn_over =   0.50, TE = 0.026, Industry_dev = 0.010, FE_BP = 0.621, FE_return = 0.355
Step 1000, Loss =     -356.425, Turn_over =   0.49, TE = 0.026, Industry_dev = 0.010, FE_BP = 0.621, FE_return = 0.356
Step 1100, Loss =     -357.343, Turn_over =   0.49, TE = 0.026, Industry_dev = 0.010, FE_BP = 0.621, FE_return = 0.357
Step 1200, Loss =     -358.260, Turn_over =   0.50, TE = 0.026, Industry_dev = 0.010, FE_BP = 0.621, FE_return = 0.358
Step 1300, Loss =     -359.178, Turn_over =   0.50, TE = 0.026, Industry_dev = 0.010, FE_BP = 0.621, FE_return = 0.359
Step 1400, Loss =     -360.097, Turn_over =   0.50, TE = 0.026, Industry_dev = 0.010, FE_BP = 0.621, FE_return = 0.360
Step 1500, Loss =     -361.014, Turn_over =   0.50, TE = 0.026, Industry_dev = 0.010, FE_BP = 0.622, FE_return = 0.361
Step 1600, Loss =     -361.932, Turn_over =   0.50, TE = 0.026, Industry_dev = 0.010, FE_BP = 0.622, FE_return = 0.362
Step 1700, Loss =     -362.823, Turn_over =   0.50, TE = 0.026, Industry_dev = 0.010, FE_BP = 0.622, FE_return = 0.363
Step 1800, Loss =     -363.705, Turn_over =   0.50, TE = 0.026, Industry_dev = 0.010, FE_BP = 0.622, FE_return = 0.364
Step 1900, Loss =     -364.591, Turn_over =   0.50, TE = 0.026, Industry_dev = 0.010, FE_BP = 0.622, FE_return = 0.365
           final_weight  initial_weight  industry        BP  return_1m
600917.SH      0.009986        0.002694      19.0 -0.252986   0.212283
600291.SH      0.008438        0.006563      28.0  5.663630   1.959708
600468.SH      0.005831        0.003330      22.0  0.090637   0.101273
600158.SH      0.015365        0.016652       8.0 -0.644805   1.841617
002238.SZ      0.006034        0.003330       5.0  0.186143   0.006393
603377.SH      0.011903        0.002155      10.0 -0.601037   1.194010
002249.SZ      0.007525        0.003575      13.0  0.838911   0.127808
002194.SZ      0.007432        0.003526       0.0  0.142115   0.016691
002251.SZ      0.004999        0.004751       1.0  0.661283   0.593054
600551.SH      0.004844        0.004947       5.0  1.171045   0.418087
603169.SH      0.006273        0.004947      13.0 -0.126952   0.418087
002551.SZ      0.012009        0.004996       2.0 -0.086085   0.406850
002646.SZ      0.012320        0.004457      16.0  0.065784   0.060180
600664.SH      0.014478        0.015428       2.0  0.582659   0.808332
002670.SZ      0.014140        0.005240       6.0  0.676036   0.418087
002366.SZ      0.016845        0.015868      13.0 -0.712173   0.846769
603025.SH      0.012641        0.002106      21.0 -0.680442   0.231040
002315.SZ      0.004073        0.004408       5.0  0.089331  -0.017601
300032.SZ      0.007299        0.005828       4.0  0.583083   0.588568
600500.SH      0.016025        0.014301      15.0  2.690432   0.631378
600435.SH      0.013810        0.013958      26.0 -0.639113   0.549292
000919.SZ      0.004483        0.005045       2.0  0.817350   0.155344
000975.SZ      0.013430        0.013273      11.0  0.100032   0.745612
600743.SH      0.011239        0.005289       8.0  1.647916   0.221738
000998.SZ      0.016208        0.014987      20.0 -0.158161   0.539101
600497.SH      0.005781        0.015966      11.0  0.643976   0.600591
600657.SH      0.004957        0.005387       8.0  3.225883   0.227389
002309.SZ      0.006263        0.005387       0.0  1.731924   0.193946
002588.SZ      0.007220        0.006024      15.0  0.366630   0.411640
600655.SH      0.013522        0.013860       1.0  1.684111   0.418087
...                 ...             ...       ...       ...        ...
000050.SZ      0.014159        0.012734       4.0  1.230090   0.418087
002422.SZ      0.012692        0.017583       2.0  1.034188   0.242045
600166.SH      0.012395        0.019737      10.0  2.623487   0.521452
002498.SZ      0.010734        0.006759      22.0  0.261198   0.219743
600971.SH      0.010700        0.004604      24.0  2.432512  -0.562138
600388.SH      0.014560        0.013664      19.0  0.102056   0.045029
600329.SH      0.010436        0.006465       2.0  0.197451   0.131590
600266.SH      0.012942        0.015770       8.0  3.072567   0.069196
000012.SZ      0.007858        0.012881      -1.0  0.420943   0.339344
002005.SZ      0.012799        0.006857       4.0  2.176651   0.227064
002311.SZ      0.007657        0.014056      20.0 -0.072472  -0.161207
600496.SH      0.007557        0.006661      18.0  1.323858   0.170558
002025.SZ      0.010475        0.007836      26.0 -0.076291   0.418087
000581.SZ      0.005085        0.016799      10.0  1.296556   0.190227
600687.SH      0.010903        0.010628      11.0  0.042257   0.777353
601010.SH      0.009965        0.008081       1.0  0.799361   0.418087
002038.SZ      0.005654        0.013909       2.0 -0.223610  -0.187060
002602.SZ      0.012763        0.013909       5.0 -0.615668  -0.160972
600086.SH      0.009881        0.008179       1.0 -0.134859   0.425039
000488.SZ      0.006290        0.013517       3.0  3.146859  -0.053670
000616.SZ      0.010015        0.007200       8.0  1.542317   0.255736
600635.SH      0.015623        0.014938      19.0  0.508774  -0.036847
000547.SZ      0.012773        0.018758      26.0 -0.061735   0.333167
600757.SH      0.010159        0.006416       5.0  1.212020   0.056013
000848.SZ      0.010392        0.008081      16.0 -0.345147   0.430524
600220.SH      0.011807        0.007346       9.0  0.157769   0.238391
600161.SH      0.007569        0.012244       2.0 -0.606072   0.418087
600881.SH      0.014165        0.013224       7.0  3.099124   0.124613
300297.SZ      0.008213        0.007151      21.0 -0.121047   0.197061
600563.SH      0.006533        0.006073       4.0 -0.055287  -0.107014

[100 rows x 5 columns]
This month excess return: -0.006937070749700069
20170406
Start Training:
First Optimization Finished!
Start Training:
Step 0   , Loss =    10549.979, Turn_over =   0.60, TE = 0.057, Industry_dev = 0.016, FE_BP = 0.569, FE_return = 0.356
Step 100 , Loss =     -181.396, Turn_over =   0.50, TE = 0.053, Industry_dev = 0.012, FE_BP = 0.570, FE_return = 0.416
Step 200 , Loss =     -231.251, Turn_over =   0.49, TE = 0.053, Industry_dev = 0.012, FE_BP = 0.571, FE_return = 0.419
Step 300 , Loss =     -277.846, Turn_over =   0.50, TE = 0.053, Industry_dev = 0.011, FE_BP = 0.571, FE_return = 0.421
Step 400 , Loss =     -312.392, Turn_over =   0.49, TE = 0.053, Industry_dev = 0.011, FE_BP = 0.571, FE_return = 0.424
Step 500 , Loss =     -344.232, Turn_over =   0.50, TE = 0.053, Industry_dev = 0.011, FE_BP = 0.571, FE_return = 0.426
Step 600 , Loss =     -370.595, Turn_over =   0.49, TE = 0.053, Industry_dev = 0.011, FE_BP = 0.570, FE_return = 0.427
Step 700 , Loss =     -402.130, Turn_over =   0.50, TE = 0.053, Industry_dev = 0.010, FE_BP = 0.570, FE_return = 0.429
Step 800 , Loss =     -428.239, Turn_over =   0.50, TE = 0.053, Industry_dev = 0.010, FE_BP = 0.570, FE_return = 0.431
Step 900 , Loss =     -433.088, Turn_over =   0.50, TE = 0.053, Industry_dev = 0.010, FE_BP = 0.570, FE_return = 0.433
Step 1000, Loss =     -435.555, Turn_over =   0.50, TE = 0.053, Industry_dev = 0.010, FE_BP = 0.570, FE_return = 0.436
Step 1100, Loss =     -438.005, Turn_over =   0.50, TE = 0.053, Industry_dev = 0.010, FE_BP = 0.570, FE_return = 0.438
Step 1200, Loss =     -440.475, Turn_over =   0.50, TE = 0.053, Industry_dev = 0.010, FE_BP = 0.570, FE_return = 0.440
Step 1300, Loss =     -442.929, Turn_over =   0.50, TE = 0.053, Industry_dev = 0.010, FE_BP = 0.570, FE_return = 0.443
Step 1400, Loss =     -445.403, Turn_over =   0.50, TE = 0.053, Industry_dev = 0.010, FE_BP = 0.570, FE_return = 0.445
Step 1500, Loss =     -447.128, Turn_over =   0.49, TE = 0.053, Industry_dev = 0.010, FE_BP = 0.570, FE_return = 0.447
Step 1600, Loss =     -449.603, Turn_over =   0.49, TE = 0.053, Industry_dev = 0.010, FE_BP = 0.570, FE_return = 0.450
Step 1700, Loss =     -452.063, Turn_over =   0.49, TE = 0.053, Industry_dev = 0.010, FE_BP = 0.570, FE_return = 0.452
Step 1800, Loss =     -454.543, Turn_over =   0.49, TE = 0.053, Industry_dev = 0.010, FE_BP = 0.570, FE_return = 0.455
Step 1900, Loss =     -457.007, Turn_over =   0.49, TE = 0.053, Industry_dev = 0.010, FE_BP = 0.570, FE_return = 0.457
           final_weight  initial_weight  industry        BP  return_1m
002277.SZ      0.016326        0.008642       1.0  1.123579   5.820572
000517.SZ      0.007894        0.004268       8.0 -0.200503   0.812777
000961.SZ      0.012215        0.010749       8.0  1.697465   2.310657
002670.SZ      0.016081        0.005111       6.0  0.882767   0.916877
000761.SZ      0.012784        0.002213      17.0  2.102137   0.517607
603567.SH      0.005921        0.004215       2.0 -0.011812   0.248435
002041.SZ      0.015242        0.006850      20.0 -0.028502   1.360888
600483.SH      0.006913        0.004532      19.0  1.551485   0.151113
603025.SH      0.012369        0.002160      21.0 -0.711857   0.276158
600628.SH      0.011428        0.006270       1.0  0.962408   0.751575
300043.SZ      0.011161        0.005902       3.0 -0.266618   0.684251
000631.SZ      0.013970        0.004690       8.0  0.921283  -0.020939
002414.SZ      0.005376        0.005533      26.0 -0.154017   0.481712
600098.SH      0.011362        0.010064      19.0  2.143359   1.215920
603806.SH      0.005484        0.004900      22.0 -0.017591   0.072683
000690.SZ      0.007571        0.015386      19.0  0.731969   0.584963
600664.SH      0.012952        0.015175       2.0  0.718027   0.518780
300113.SZ      0.007101        0.013753       5.0 -0.522049   0.844152
002701.SZ      0.006072        0.015175       3.0  0.015248   0.524614
600497.SH      0.013063        0.015702      11.0  0.753864   0.502821
603528.SH      0.004854        0.005058      21.0 -0.719406   0.146562
600503.SH      0.007079        0.015913       8.0  0.208710   0.435886
002698.SZ      0.012237        0.005480      13.0 -0.378499   0.232782
000975.SZ      0.008684        0.012330      11.0  0.162305   1.083683
002038.SZ      0.013610        0.013858       2.0 -0.190945   0.564722
600850.SH      0.011044        0.006376      21.0 -0.272720   0.491794
002439.SZ      0.013129        0.015755      21.0 -0.662100   0.485769
600831.SH      0.010595        0.005954       5.0  0.478808   0.249663
300026.SZ      0.012290        0.016545       2.0  0.529236   0.465713
002491.SZ      0.016327        0.013805       0.0 -0.452545   0.569752
...                 ...             ...       ...       ...        ...
600175.SH      0.011239        0.008694      -1.0  1.798857   0.461769
600673.SH      0.005364        0.016493      11.0 -0.110812   0.079296
600635.SH      0.006546        0.016177      19.0  0.778877  -0.036359
002681.SZ      0.008060        0.006323       4.0 -0.371658   0.079296
002254.SZ      0.009798        0.007008      12.0  0.083968   0.227280
300273.SZ      0.010497        0.010380       2.0 -0.137988   0.875832
601168.SH      0.004364        0.019496      11.0  2.028576   0.079296
002400.SZ      0.011741        0.016914       5.0  0.171450   0.079296
600687.SH      0.010181        0.010275      11.0  0.095922   0.822720
600240.SH      0.014354        0.014174       8.0  0.320544  -0.130446
002602.SZ      0.006265        0.013964       5.0 -0.656526   0.108212
600537.SH      0.010270        0.007640      22.0  0.469852   0.297121
002273.SZ      0.008128        0.015755       4.0 -0.294553  -0.073901
000598.SZ      0.014012        0.013542      -1.0  1.177023   0.153371
603005.SH      0.014513        0.004953       4.0 -0.171900  -0.570704
002354.SZ      0.007074        0.007482       5.0  0.033987   0.291180
000636.SZ      0.013167        0.008378       4.0  1.060381   0.362955
002223.SZ      0.005919        0.014016       2.0 -0.164508  -0.151879
600267.SH      0.009565        0.009854       2.0  1.768044   0.483777
300199.SZ      0.009685        0.009695       2.0 -0.105072   0.696182
000400.SZ      0.006759        0.013964      22.0  0.677812  -0.094628
000543.SZ      0.010198        0.009801      19.0  3.442386   0.318540
600894.SH      0.010586        0.007588      13.0  1.474433   0.152459
600496.SH      0.011067        0.007061      18.0  1.236128   0.025173
000959.SZ      0.005276        0.014807      17.0  2.500909  -0.408133
002221.SZ      0.012862        0.013595      12.0  0.207074   0.145638
600284.SH      0.009098        0.008747      18.0  1.746453   0.343713
600079.SH      0.004653        0.023237       2.0  0.948175   0.399754
002128.SZ      0.009332        0.007693      24.0  1.775061   0.128021
001696.SZ      0.007787        0.007746      13.0  0.601042   0.256463

[100 rows x 5 columns]
This month excess return: -0.038366466760635376
20170505
Start Training:
First Optimization Finished!
Start Training:
Step 0   , Loss =    28111.850, Turn_over =   0.77, TE = 0.050, Industry_dev = 0.018, FE_BP = 0.585, FE_return = 0.225
Step 100 , Loss =      118.398, Turn_over =   0.49, TE = 0.055, Industry_dev = 0.014, FE_BP = 0.529, FE_return = 0.286
Step 200 , Loss =       60.620, Turn_over =   0.50, TE = 0.055, Industry_dev = 0.014, FE_BP = 0.526, FE_return = 0.297
Step 300 , Loss =       16.698, Turn_over =   0.49, TE = 0.055, Industry_dev = 0.013, FE_BP = 0.525, FE_return = 0.306
Step 400 , Loss =      -21.639, Turn_over =   0.49, TE = 0.055, Industry_dev = 0.013, FE_BP = 0.523, FE_return = 0.315
Step 500 , Loss =      -67.771, Turn_over =   0.50, TE = 0.054, Industry_dev = 0.013, FE_BP = 0.520, FE_return = 0.327
Step 600 , Loss =     -105.346, Turn_over =   0.49, TE = 0.054, Industry_dev = 0.012, FE_BP = 0.519, FE_return = 0.335
Step 700 , Loss =     -142.628, Turn_over =   0.49, TE = 0.054, Industry_dev = 0.012, FE_BP = 0.517, FE_return = 0.345
Step 800 , Loss =     -188.754, Turn_over =   0.50, TE = 0.054, Industry_dev = 0.012, FE_BP = 0.515, FE_return = 0.356
Step 900 , Loss =     -223.358, Turn_over =   0.49, TE = 0.054, Industry_dev = 0.011, FE_BP = 0.514, FE_return = 0.365
Step 1000, Loss =     -256.928, Turn_over =   0.49, TE = 0.053, Industry_dev = 0.011, FE_BP = 0.513, FE_return = 0.374
Step 1100, Loss =     -299.633, Turn_over =   0.50, TE = 0.053, Industry_dev = 0.011, FE_BP = 0.511, FE_return = 0.386
Step 1200, Loss =     -333.900, Turn_over =   0.49, TE = 0.053, Industry_dev = 0.011, FE_BP = 0.511, FE_return = 0.395
Step 1300, Loss =     -372.438, Turn_over =   0.50, TE = 0.053, Industry_dev = 0.010, FE_BP = 0.509, FE_return = 0.405
Step 1400, Loss =     -393.843, Turn_over =   0.49, TE = 0.053, Industry_dev = 0.010, FE_BP = 0.509, FE_return = 0.407
Step 1500, Loss =     -408.974, Turn_over =   0.49, TE = 0.053, Industry_dev = 0.010, FE_BP = 0.509, FE_return = 0.409
Step 1600, Loss =     -410.007, Turn_over =   0.50, TE = 0.053, Industry_dev = 0.010, FE_BP = 0.510, FE_return = 0.410
Step 1700, Loss =     -411.036, Turn_over =   0.50, TE = 0.053, Industry_dev = 0.010, FE_BP = 0.510, FE_return = 0.411
Step 1800, Loss =     -412.060, Turn_over =   0.50, TE = 0.053, Industry_dev = 0.010, FE_BP = 0.510, FE_return = 0.412
Step 1900, Loss =     -413.079, Turn_over =   0.50, TE = 0.053, Industry_dev = 0.010, FE_BP = 0.511, FE_return = 0.413
           final_weight  initial_weight  industry        BP  return_1m
002281.SZ      0.019508        0.007876       0.0 -0.325679   8.903716
002056.SZ      0.007136        0.006469       4.0  0.284229   4.720333
600425.SH      0.009000        0.004219       7.0  1.479734   2.656307
600981.SH      0.004338        0.002344       1.0  0.856602   0.030901
600112.SH      0.007960        0.004360      22.0  0.221184   1.886465
002572.SZ      0.012634        0.023065       3.0 -0.739327   2.681647
600088.SH      0.002652        0.002813       5.0 -0.478944   0.075078
601016.SH      0.010606        0.003750      19.0  0.598869   4.095632
603567.SH      0.014207        0.003610       2.0 -0.017614   0.187966
600397.SH      0.003909        0.003750      24.0  0.018294   0.284412
603001.SH      0.003634        0.003844       9.0  0.974434   0.270778
603025.SH      0.007088        0.001735      21.0 -0.808038   0.387208
002251.SZ      0.004048        0.003891       1.0  1.310814   0.246947
600614.SH      0.009006        0.014720      -1.0 -0.183641   0.594310
603328.SH      0.012194        0.003657       4.0  0.109265  -0.087508
002646.SZ      0.005076        0.003938      16.0  0.042882   0.042085
002439.SZ      0.008264        0.013877      21.0 -0.477788   0.443030
603005.SH      0.011452        0.004079       4.0 -0.225256   0.007707
000631.SZ      0.006242        0.003985       8.0  0.837390  -0.150520
002698.SZ      0.011312        0.004594      13.0 -0.407468   0.206389
000690.SZ      0.013648        0.009751      19.0  1.269182   1.264117
600158.SH      0.011418        0.012283       8.0 -0.645735   0.619613
000878.SZ      0.012389        0.012939      11.0  0.347065   0.303534
600503.SH      0.016128        0.012892       8.0  0.179516   0.277658
002503.SZ      0.007586        0.008157       9.0 -0.289828   2.298114
002371.SZ      0.005267        0.005485       4.0 -0.012467   0.403380
000930.SZ      0.006132        0.013361      20.0 -0.589832   0.091210
600251.SH      0.003973        0.004454      20.0  0.215241  -0.065296
600497.SH      0.011943        0.012611      11.0  0.649985   0.299218
002727.SZ      0.012790        0.005813       2.0 -0.078895   0.421405
...                 ...             ...       ...       ...        ...
600166.SH      0.015345        0.017346      10.0  2.726335  -0.166751
002001.SZ      0.012511        0.012095       2.0  0.494646   0.027035
002161.SZ      0.014750        0.005672       0.0 -0.280515  -0.018148
000931.SZ      0.005806        0.005438      -1.0 -0.130131  -0.064463
600180.SH      0.007282        0.005016      14.0  0.195184  -0.240932
600755.SH      0.012051        0.012798       1.0  3.699852  -0.480442
601777.SH      0.005474        0.006094      10.0  1.572322   0.009737
000066.SZ      0.013248        0.022924      21.0 -0.133973   0.291689
300113.SZ      0.005900        0.012423       5.0 -0.631938  -0.352104
600143.SH      0.007586        0.015142      15.0  0.697154  -0.409684
600673.SH      0.007147        0.015095      11.0 -0.266858  -0.409684
300159.SZ      0.012141        0.013408      13.0 -0.185011  -0.615147
600335.SH      0.004281        0.004969      10.0  1.007799  -0.376047
000825.SZ      0.009000        0.012001      17.0  2.704122   0.020511
000021.SZ      0.010562        0.007032       4.0  0.667963   0.204915
600418.SH      0.008429        0.011861      10.0  2.062631   0.090405
002092.SZ      0.014111        0.019080      15.0  1.578287  -0.075123
603589.SH      0.009790        0.012142      16.0 -0.302141  -0.311286
002353.SZ      0.009930        0.009939      13.0  0.819276   0.585112
002602.SZ      0.010437        0.011486       5.0 -0.649863   0.124227
000572.SZ      0.006739        0.007313      10.0  3.308771   0.057670
600850.SH      0.011254        0.005532      21.0 -0.305883  -0.181521
600759.SH      0.011058        0.008626      12.0  0.484707   0.446714
600584.SH      0.013625        0.021659       4.0  0.314350   0.112435
000050.SZ      0.011269        0.011579       4.0  1.159052   0.068287
002410.SZ      0.007391        0.012798      21.0 -0.549537  -0.647386
601699.SH      0.010641        0.011392      24.0  2.255421   0.146014
000762.SZ      0.009500        0.007407      11.0  0.102591   0.192672
002269.SZ      0.009442        0.006235       9.0 -0.018065  -0.030639
002400.SZ      0.007323        0.015517       5.0 -0.006003  -0.409684

[100 rows x 5 columns]
This month excess return: -0.0218537375330925
20170606
Start Training:
First Optimization Finished!
Start Training:
Step 0   , Loss =    20121.029, Turn_over =   0.66, TE = 0.044, Industry_dev = 0.015, FE_BP = 0.462, FE_return = 0.442
Step 100 , Loss =      666.490, Turn_over =   0.51, TE = 0.041, Industry_dev = 0.014, FE_BP = 0.943, FE_return = 0.421
Step 200 , Loss =      -89.914, Turn_over =   0.50, TE = 0.041, Industry_dev = 0.013, FE_BP = 0.938, FE_return = 0.426
Step 300 , Loss =     -123.659, Turn_over =   0.49, TE = 0.041, Industry_dev = 0.013, FE_BP = 0.934, FE_return = 0.430
Step 400 , Loss =     -158.120, Turn_over =   0.50, TE = 0.041, Industry_dev = 0.013, FE_BP = 0.931, FE_return = 0.435
Step 500 , Loss =     -192.432, Turn_over =   0.50, TE = 0.040, Industry_dev = 0.012, FE_BP = 0.927, FE_return = 0.440
Step 600 , Loss =     -223.736, Turn_over =   0.49, TE = 0.040, Industry_dev = 0.012, FE_BP = 0.924, FE_return = 0.444
Step 700 , Loss =     -256.917, Turn_over =   0.50, TE = 0.040, Industry_dev = 0.012, FE_BP = 0.920, FE_return = 0.448
Step 800 , Loss =     -289.915, Turn_over =   0.50, TE = 0.040, Industry_dev = 0.012, FE_BP = 0.916, FE_return = 0.453
Step 900 , Loss =     -318.423, Turn_over =   0.50, TE = 0.040, Industry_dev = 0.011, FE_BP = 0.912, FE_return = 0.457
Step 1000, Loss =     -347.926, Turn_over =   0.50, TE = 0.040, Industry_dev = 0.011, FE_BP = 0.909, FE_return = 0.462
Step 1100, Loss =     -374.353, Turn_over =   0.49, TE = 0.040, Industry_dev = 0.011, FE_BP = 0.906, FE_return = 0.466
Step 1200, Loss =     -403.238, Turn_over =   0.50, TE = 0.040, Industry_dev = 0.011, FE_BP = 0.902, FE_return = 0.470
Step 1300, Loss =     -425.887, Turn_over =   0.49, TE = 0.039, Industry_dev = 0.010, FE_BP = 0.899, FE_return = 0.474
Step 1400, Loss =     -452.143, Turn_over =   0.50, TE = 0.039, Industry_dev = 0.010, FE_BP = 0.897, FE_return = 0.478
Step 1500, Loss =     -477.935, Turn_over =   0.50, TE = 0.039, Industry_dev = 0.010, FE_BP = 0.894, FE_return = 0.482
Step 1600, Loss =     -486.578, Turn_over =   0.50, TE = 0.039, Industry_dev = 0.010, FE_BP = 0.893, FE_return = 0.487
Step 1700, Loss =     -490.766, Turn_over =   0.49, TE = 0.039, Industry_dev = 0.010, FE_BP = 0.892, FE_return = 0.491
Step 1800, Loss =     -495.905, Turn_over =   0.49, TE = 0.039, Industry_dev = 0.010, FE_BP = 0.891, FE_return = 0.496
Step 1900, Loss =     -501.019, Turn_over =   0.50, TE = 0.039, Industry_dev = 0.010, FE_BP = 0.891, FE_return = 0.501
           final_weight  initial_weight  industry        BP  return_1m
002354.SZ      0.010370        0.007497       5.0  0.073390   8.176988
603766.SH      0.010532        0.009898      10.0  0.542206   5.915706
300296.SZ      0.014378        0.019257       4.0 -0.663656   3.691130
300253.SZ      0.009353        0.011074      21.0 -0.422906   3.791333
601908.SH      0.014479        0.003724      22.0  1.408729   0.575142
002589.SZ      0.013263        0.009212       2.0  0.068821   4.939418
002699.SZ      0.006096        0.004802       9.0 -0.191436   1.016113
002223.SZ      0.011520        0.014994       2.0 -0.316323   1.506520
600112.SH      0.008093        0.004165      22.0  0.254433   0.527712
603025.SH      0.015765        0.001715      21.0 -0.797401   0.193362
603555.SH      0.005155        0.003528       9.0 -0.306364  -0.103799
002698.SZ      0.009462        0.004263      13.0 -0.304091   0.347699
600823.SH      0.033963        0.007252       8.0  5.380482   1.265530
000517.SZ      0.006122        0.003773       8.0 -0.160667  -0.161491
000631.SZ      0.003837        0.004165       8.0  0.878665  -0.029303
002315.SZ      0.007230        0.003969       5.0  0.111510   4.155329
000401.SZ      0.004413        0.015386       7.0  0.690155   0.681475
002327.SZ      0.006858        0.004802       9.0  0.253743   0.152494
600151.SH      0.005471        0.008526      22.0  1.032781   1.285246
000547.SZ      0.009555        0.013083      26.0  0.254849   0.907793
000761.SZ      0.001500        0.001911      17.0  2.386493  -0.059970
600971.SH      0.016539        0.004753      24.0  2.123539  -0.105795
002635.SZ      0.012319        0.012642      21.0 -0.751202   0.932868
603005.SH      0.008332        0.004263       4.0 -0.287826  -0.336052
002400.SZ      0.010411        0.012740       5.0  0.363188   0.925156
002573.SZ      0.011209        0.015386      19.0 -0.466052   0.524027
002118.SZ      0.005358        0.004459       2.0  0.504595  -0.398008
002366.SZ      0.006532        0.014455      13.0 -0.807435   0.218920
002005.SZ      0.006695        0.005831       4.0  2.364002   0.223627
000501.SZ      0.006485        0.008428       1.0  0.745890   0.966522
...                 ...             ...       ...       ...        ...
600260.SH      0.008996        0.014014      -1.0 -0.326830  -0.400937
601168.SH      0.017144        0.017101      11.0  2.084305  -0.082867
600655.SH      0.013612        0.015239       1.0  1.450932  -0.342996
000566.SZ      0.010954        0.014455       2.0  0.014316  -0.324326
002269.SZ      0.005208        0.006370       9.0  0.040672  -0.008476
600978.SH      0.007381        0.015533      20.0  0.759946  -0.210795
603589.SH      0.008565        0.014161      16.0 -0.441214  -0.433868
002073.SZ      0.008190        0.007203      13.0  1.267057   0.138214
600528.SH      0.012448        0.016905      18.0  0.450331  -0.071150
600122.SH      0.012202        0.013818       1.0  1.338692  -0.408189
000598.SZ      0.013155        0.013230      -1.0  0.969470  -0.142680
600755.SH      0.023582        0.013132       1.0  3.900323  -0.180047
300159.SZ      0.009719        0.015043      13.0 -0.222034  -0.351992
600198.SH      0.010621        0.011074       0.0 -0.402632   0.829389
002092.SZ      0.015325        0.018816      15.0  1.696350   0.058842
002029.SZ      0.012985        0.005978       9.0  1.620557  -0.293168
000400.SZ      0.011485        0.013034      22.0  0.567198  -0.099470
001696.SZ      0.011136        0.006615      13.0  0.693187  -0.049137
000636.SZ      0.007549        0.006811       4.0  1.355255  -0.018365
600657.SH      0.005326        0.005978       8.0  2.787653  -0.372486
600511.SH      0.008104        0.013426       2.0 -0.662978  -0.275084
002701.SZ      0.009152        0.012250       3.0  0.130116   0.319965
600098.SH      0.020107        0.008085      19.0  2.433365   0.226219
600160.SH      0.004162        0.012887      15.0  0.467482   0.076328
600058.SH      0.006201        0.006909      17.0  0.314823   0.039538
002123.SZ      0.010155        0.006615      -1.0  0.783754  -0.046805
002479.SZ      0.008816        0.007448      19.0  0.075602   0.174815
002217.SZ      0.012889        0.010927       4.0  0.032098   3.242042
600645.SH      0.010288        0.008771       2.0 -0.494810   0.499382
000878.SZ      0.012069        0.012985      11.0  0.338042  -0.015549

[100 rows x 5 columns]
This month excess return: 0.0013625537976622581
20170704
Start Training:
First Optimization Finished!
Start Training:
Step 0   , Loss =    22565.617, Turn_over =   0.72, TE = 0.050, Industry_dev = 0.016, FE_BP = 0.738, FE_return = 0.358
Step 100 , Loss =    10110.041, Turn_over =   0.60, TE = 0.037, Industry_dev = 0.012, FE_BP = 0.757, FE_return = 0.252
Step 200 , Loss =      -79.330, Turn_over =   0.50, TE = 0.037, Industry_dev = 0.012, FE_BP = 0.765, FE_return = 0.252
Step 300 , Loss =     -125.924, Turn_over =   0.49, TE = 0.037, Industry_dev = 0.011, FE_BP = 0.766, FE_return = 0.257
Step 400 , Loss =     -175.614, Turn_over =   0.49, TE = 0.037, Industry_dev = 0.011, FE_BP = 0.765, FE_return = 0.263
Step 500 , Loss =     -225.393, Turn_over =   0.50, TE = 0.037, Industry_dev = 0.010, FE_BP = 0.765, FE_return = 0.269
Step 600 , Loss =     -270.503, Turn_over =   0.49, TE = 0.037, Industry_dev = 0.010, FE_BP = 0.766, FE_return = 0.274
Step 700 , Loss =     -279.636, Turn_over =   0.49, TE = 0.037, Industry_dev = 0.010, FE_BP = 0.765, FE_return = 0.280
Step 800 , Loss =     -285.656, Turn_over =   0.49, TE = 0.037, Industry_dev = 0.010, FE_BP = 0.764, FE_return = 0.286
Step 900 , Loss =     -291.677, Turn_over =   0.49, TE = 0.037, Industry_dev = 0.010, FE_BP = 0.763, FE_return = 0.292
Step 1000, Loss =     -296.554, Turn_over =   0.49, TE = 0.037, Industry_dev = 0.010, FE_BP = 0.763, FE_return = 0.297
Step 1100, Loss =     -299.133, Turn_over =   0.49, TE = 0.037, Industry_dev = 0.010, FE_BP = 0.763, FE_return = 0.299
Step 1200, Loss =     -301.685, Turn_over =   0.49, TE = 0.037, Industry_dev = 0.010, FE_BP = 0.763, FE_return = 0.302
Step 1300, Loss =     -304.209, Turn_over =   0.50, TE = 0.038, Industry_dev = 0.010, FE_BP = 0.762, FE_return = 0.304
Step 1400, Loss =     -306.706, Turn_over =   0.50, TE = 0.038, Industry_dev = 0.010, FE_BP = 0.762, FE_return = 0.307
Step 1500, Loss =     -309.179, Turn_over =   0.50, TE = 0.038, Industry_dev = 0.010, FE_BP = 0.762, FE_return = 0.309
Step 1600, Loss =     -311.626, Turn_over =   0.50, TE = 0.038, Industry_dev = 0.010, FE_BP = 0.762, FE_return = 0.312
Step 1700, Loss =     -312.554, Turn_over =   0.49, TE = 0.038, Industry_dev = 0.010, FE_BP = 0.762, FE_return = 0.313
Step 1800, Loss =     -314.971, Turn_over =   0.49, TE = 0.038, Industry_dev = 0.010, FE_BP = 0.762, FE_return = 0.315
Step 1900, Loss =     -317.063, Turn_over =   0.49, TE = 0.038, Industry_dev = 0.010, FE_BP = 0.762, FE_return = 0.317
           final_weight  initial_weight  industry        BP  return_1m
603528.SH      0.007666        0.003049      21.0 -0.655891   6.807555
603888.SH      0.013258        0.005735       5.0 -0.697408   5.665551
600325.SH      0.009601        0.016157       8.0  4.124190   3.240442
600879.SH      0.013647        0.016384      26.0  0.700240   2.793988
000939.SZ      0.009518        0.009148      19.0  1.361099   3.442065
300266.SZ      0.012561        0.017841      19.0 -0.882428   2.657807
002223.SZ      0.014557        0.013563       2.0 -0.352494   1.711405
002268.SZ      0.008953        0.008056      21.0 -0.079346   2.661714
603328.SH      0.007088        0.003231       4.0  0.134999   3.921597
002217.SZ      0.011623        0.014109       4.0 -0.058981   3.532215
600126.SH      0.003276        0.003049      17.0  2.152335  -0.264899
600426.SH      0.015479        0.015201      15.0  0.585000   0.689686
600161.SH      0.015509        0.014837       2.0 -0.900038   0.777227
603025.SH      0.006013        0.001502      21.0 -0.807611  -0.022930
601000.SH      0.012737        0.013563      14.0  1.361311   0.170778
000778.SZ      0.007425        0.015247      17.0  1.829115   0.164484
600166.SH      0.007347        0.015110      10.0  2.922967  -0.033714
603005.SH      0.011245        0.003641       4.0 -0.233236   0.015499
002646.SZ      0.003359        0.003595      16.0  0.074856  -0.078329
600839.SH      0.009057        0.015247       6.0  3.800528  -0.285301
600618.SH      0.004023        0.002731      -1.0 -0.679676  -0.729594
603568.SH      0.010062        0.003368      19.0 -0.715264  -0.167196
600978.SH      0.013314        0.013608      20.0  0.839454  -0.022048
300159.SZ      0.012484        0.011242      13.0 -0.058459   0.762086
300166.SZ      0.009765        0.009649      21.0 -0.154371   1.347805
000062.SZ      0.006296        0.006554       8.0 -0.400585   0.883403
603569.SH      0.005421        0.001684      10.0 -0.702010   0.197647
603698.SH      0.004058        0.003550      13.0 -0.341866  -0.276660
600655.SH      0.014035        0.013017       1.0  1.588967  -0.006493
600600.SH      0.013454        0.013927      16.0  0.257135  -0.052367
...                 ...             ...       ...       ...        ...
600435.SH      0.013645        0.014610      26.0 -0.787968  -0.151067
300324.SZ      0.011569        0.011970      21.0 -0.297890  -0.010683
000761.SZ      0.011848        0.001775      17.0  2.102086  -0.457596
600298.SH      0.011505        0.012152      16.0 -0.530027  -0.159644
601777.SH      0.005500        0.005780      10.0  1.550321  -0.044986
000400.SZ      0.009709        0.012379      22.0  0.463368  -0.343372
002038.SZ      0.014317        0.013654       2.0 -0.447982  -0.450975
600751.SH      0.009073        0.008374      14.0  3.032152   0.108592
601002.SH      0.004965        0.004688      13.0  0.241271  -0.201122
600335.SH      0.003626        0.004233      10.0  1.143305  -0.574028
600720.SH      0.010841        0.005553       7.0  2.362620  -0.288705
000727.SZ      0.010467        0.008784       4.0  4.577324  -0.089022
600635.SH      0.008903        0.012015      19.0  0.941369  -0.105758
300032.SZ      0.005607        0.005188       4.0  0.442395  -0.080821
601016.SH      0.008171        0.006963      19.0  0.636608   0.308270
000547.SZ      0.011209        0.011924      26.0  0.224393  -0.191854
600521.SH      0.015718        0.015019       2.0 -0.414502  -0.338362
600755.SH      0.012797        0.012106       1.0  3.772510  -0.299712
000620.SZ      0.009058        0.006144       8.0  0.885589   0.058745
600971.SH      0.010895        0.004642      24.0  1.814887  -0.540678
600503.SH      0.008123        0.012652       8.0  0.099855  -0.561767
000930.SZ      0.008678        0.011879      20.0 -0.601829  -0.300206
600428.SH      0.009048        0.006099      14.0  1.644009  -0.130857
603198.SH      0.009083        0.005188      16.0 -0.139988  -0.082336
600917.SH      0.005071        0.001820      19.0 -0.135152   0.005851
600640.SH      0.004004        0.004597      23.0  0.186953  -0.332416
000541.SZ      0.006617        0.006099       6.0  0.574497   0.057319
601168.SH      0.015402        0.016749      11.0  1.666548  -0.530780
002001.SZ      0.009837        0.012061       2.0  0.316597  -0.378246
000581.SZ      0.013904        0.014837      10.0  0.934582  -0.646553

[100 rows x 5 columns]
This month excess return: -0.027140500023961067
20170801
Start Training:
First Optimization Finished!
Start Training:
Step 0   , Loss =    26758.293, Turn_over =   0.75, TE = 0.056, Industry_dev = 0.023, FE_BP = 1.620, FE_return = 0.014
Step 100 , Loss =      738.010, Turn_over =   0.49, TE = 0.039, Industry_dev = 0.018, FE_BP = 1.610, FE_return = 0.080
Step 200 , Loss =      694.723, Turn_over =   0.50, TE = 0.039, Industry_dev = 0.018, FE_BP = 1.605, FE_return = 0.085
Step 300 , Loss =      660.398, Turn_over =   0.49, TE = 0.039, Industry_dev = 0.018, FE_BP = 1.604, FE_return = 0.090
Step 400 , Loss =      618.197, Turn_over =   0.50, TE = 0.039, Industry_dev = 0.017, FE_BP = 1.599, FE_return = 0.095
Step 500 , Loss =      585.212, Turn_over =   0.49, TE = 0.039, Industry_dev = 0.017, FE_BP = 1.598, FE_return = 0.100
Step 600 , Loss =      554.268, Turn_over =   0.49, TE = 0.039, Industry_dev = 0.017, FE_BP = 1.596, FE_return = 0.104
Step 700 , Loss =      518.185, Turn_over =   0.50, TE = 0.039, Industry_dev = 0.016, FE_BP = 1.592, FE_return = 0.108
Step 800 , Loss =      490.570, Turn_over =   0.49, TE = 0.040, Industry_dev = 0.016, FE_BP = 1.591, FE_return = 0.112
Step 900 , Loss =      454.305, Turn_over =   0.50, TE = 0.040, Industry_dev = 0.016, FE_BP = 1.586, FE_return = 0.117
Step 1000, Loss =      426.633, Turn_over =   0.49, TE = 0.040, Industry_dev = 0.015, FE_BP = 1.585, FE_return = 0.121
Step 1100, Loss =      399.626, Turn_over =   0.49, TE = 0.040, Industry_dev = 0.015, FE_BP = 1.584, FE_return = 0.125
Step 1200, Loss =      362.943, Turn_over =   0.50, TE = 0.040, Industry_dev = 0.015, FE_BP = 1.579, FE_return = 0.130
Step 1300, Loss =      337.485, Turn_over =   0.50, TE = 0.040, Industry_dev = 0.015, FE_BP = 1.578, FE_return = 0.134
Step 1400, Loss =      313.070, Turn_over =   0.49, TE = 0.040, Industry_dev = 0.015, FE_BP = 1.577, FE_return = 0.137
Step 1500, Loss =      288.783, Turn_over =   0.49, TE = 0.040, Industry_dev = 0.014, FE_BP = 1.576, FE_return = 0.141
Step 1600, Loss =      253.470, Turn_over =   0.50, TE = 0.040, Industry_dev = 0.014, FE_BP = 1.572, FE_return = 0.145
Step 1700, Loss =      229.079, Turn_over =   0.49, TE = 0.041, Industry_dev = 0.014, FE_BP = 1.572, FE_return = 0.149
Step 1800, Loss =      204.553, Turn_over =   0.49, TE = 0.041, Industry_dev = 0.014, FE_BP = 1.571, FE_return = 0.153
Step 1900, Loss =      181.715, Turn_over =   0.49, TE = 0.041, Industry_dev = 0.013, FE_BP = 1.570, FE_return = 0.157
           final_weight  initial_weight  industry        BP  return_1m
000543.SZ      0.009471        0.006897      19.0  5.046252   0.002175
000727.SZ      0.015141        0.008553       4.0  4.836758  -0.031902
600325.SH      0.005998        0.015588       8.0  4.380363   0.156269
600839.SH      0.019177        0.015312       6.0  3.872028  -0.177765
600642.SH      0.013188        0.019128      19.0  3.837006  -0.073715
600657.SH      0.009602        0.004920       8.0  3.212843  -0.122667
600219.SH      0.013008        0.022899      11.0  3.006211  -0.538157
600717.SH      0.010557        0.011495      14.0  3.074595   0.055897
600266.SH      0.013709        0.014438       8.0  2.906957   0.338733
000926.SZ      0.009492        0.010530       8.0  3.001638  -0.176257
600166.SH      0.013954        0.015082      10.0  3.010995  -0.140315
600098.SH      0.009647        0.006805      19.0  2.701230  -0.006056
603077.SH      0.014177        0.009472      15.0  0.901704   5.555647
600859.SH      0.005019        0.005656       1.0  2.475823  -0.081777
600751.SH      0.007652        0.009058      14.0  2.772600  -0.600194
000600.SZ      0.008208        0.008231      19.0  1.884003   1.453907
000528.SZ      0.011068        0.008185      13.0  2.424172  -0.468849
600500.SH      0.008729        0.012599      15.0  2.630362  -0.796920
600755.SH      0.005638        0.015220       1.0  2.800837  -1.254613
600736.SH      0.009445        0.005656       8.0  2.085556  -0.108227
601811.SH      0.004832        0.001655       5.0  0.682687   0.245401
600064.SH      0.008413        0.009840       8.0  2.393945  -0.495575
600022.SH      0.012137        0.017473      17.0  2.567118  -0.766063
600466.SH      0.008980        0.008553       8.0  2.151597  -0.134076
601717.SH      0.010928        0.007817      13.0  2.102641  -0.116133
600881.SH      0.012943        0.009840       7.0  2.146600  -0.254444
002344.SZ      0.004213        0.004690       1.0  1.698514   0.052820
000729.SZ      0.010830        0.010116      16.0  1.985512   0.100405
600017.SH      0.008367        0.009702      14.0  2.165229  -0.459350
000656.SZ      0.007263        0.015680       8.0  2.074337   1.150472
...                 ...             ...       ...       ...        ...
601929.SH      0.008816        0.008369       5.0  1.246892  -0.063218
600565.SH      0.008889        0.008736       8.0  1.217970   0.039147
601168.SH      0.018043        0.020462      11.0  1.209699  -1.123267
000513.SZ      0.010764        0.009932       2.0 -0.172257   1.789149
600416.SH      0.015611        0.007817      22.0  1.098808   0.317514
600026.SH      0.007958        0.010530      14.0  3.085406  -0.330736
000089.SZ      0.009806        0.010346      14.0  1.220143   0.171991
000620.SZ      0.005265        0.005840       8.0  1.016346   0.107360
000572.SZ      0.005633        0.006345      10.0  3.905437   0.083953
600291.SH      0.010468        0.026899      28.0  1.712333  -2.298042
600537.SH      0.007274        0.004552      22.0  0.928271  -0.163907
600600.SH      0.013222        0.013059      16.0  0.324330   0.084361
600161.SH      0.012288        0.011679       2.0 -0.844260   1.178775
600062.SH      0.012002        0.010254       2.0  0.375821   1.401215
002477.SZ      0.013265        0.009058      20.0  1.121658   0.126725
601233.SH      0.009020        0.006345      12.0  1.272510  -0.724756
600143.SH      0.011140        0.010944      15.0  1.286397  -0.258435
000860.SZ      0.010518        0.009150      16.0  1.263428  -0.334244
002815.SZ      0.009691        0.001793       4.0 -0.652134   0.359696
002223.SZ      0.010275        0.010714       2.0 -0.146109   0.931255
300055.SZ      0.010898        0.011633      19.0  0.295057   0.338598
000158.SZ      0.010504        0.007633      -1.0  0.105418   2.795257
600240.SH      0.010835        0.012047       8.0  0.517921  -0.252166
000825.SZ      0.006080        0.012645      17.0  2.277422  -0.759304
601699.SH      0.005800        0.013013      24.0  1.460034  -1.093074
600831.SH      0.003654        0.004046       5.0  0.730657  -0.199369
600528.SH      0.008457        0.014944      18.0  0.445311  -0.306138
300113.SZ      0.009185        0.009196       5.0 -0.507995   1.672032
600160.SH      0.012122        0.012093      15.0  0.358071  -0.541911
603528.SH      0.009709        0.002299      21.0 -0.492863   1.613048

[100 rows x 5 columns]
This month excess return: 0.0007374987471848726
20170829
Start Training:
First Optimization Finished!
Start Training:
Step 0   , Loss =    22843.877, Turn_over =   0.72, TE = 0.041, Industry_dev = 0.021, FE_BP = 0.989, FE_return = 0.450
Step 100 , Loss =      155.051, Turn_over =   0.50, TE = 0.028, Industry_dev = 0.016, FE_BP = 1.060, FE_return = 0.421
Step 200 , Loss =      101.488, Turn_over =   0.50, TE = 0.028, Industry_dev = 0.015, FE_BP = 1.055, FE_return = 0.422
Step 300 , Loss =       52.986, Turn_over =   0.49, TE = 0.027, Industry_dev = 0.015, FE_BP = 1.051, FE_return = 0.423
Step 400 , Loss =       -0.581, Turn_over =   0.49, TE = 0.027, Industry_dev = 0.014, FE_BP = 1.046, FE_return = 0.423
Step 500 , Loss =      -52.229, Turn_over =   0.50, TE = 0.027, Industry_dev = 0.014, FE_BP = 1.041, FE_return = 0.424
Step 600 , Loss =      -96.976, Turn_over =   0.49, TE = 0.027, Industry_dev = 0.013, FE_BP = 1.037, FE_return = 0.424
Step 700 , Loss =     -144.222, Turn_over =   0.49, TE = 0.027, Industry_dev = 0.013, FE_BP = 1.032, FE_return = 0.425
Step 800 , Loss =     -187.404, Turn_over =   0.49, TE = 0.027, Industry_dev = 0.012, FE_BP = 1.027, FE_return = 0.425
Step 900 , Loss =     -230.281, Turn_over =   0.50, TE = 0.027, Industry_dev = 0.012, FE_BP = 1.021, FE_return = 0.426
Step 1000, Loss =     -267.118, Turn_over =   0.49, TE = 0.027, Industry_dev = 0.012, FE_BP = 1.018, FE_return = 0.427
Step 1100, Loss =     -307.323, Turn_over =   0.49, TE = 0.027, Industry_dev = 0.011, FE_BP = 1.012, FE_return = 0.427
Step 1200, Loss =     -346.529, Turn_over =   0.50, TE = 0.027, Industry_dev = 0.011, FE_BP = 1.006, FE_return = 0.427
Step 1300, Loss =     -380.783, Turn_over =   0.49, TE = 0.027, Industry_dev = 0.010, FE_BP = 1.002, FE_return = 0.428
Step 1400, Loss =     -420.001, Turn_over =   0.50, TE = 0.028, Industry_dev = 0.010, FE_BP = 0.996, FE_return = 0.429
Step 1500, Loss =     -429.354, Turn_over =   0.50, TE = 0.028, Industry_dev = 0.010, FE_BP = 0.995, FE_return = 0.429
Step 1600, Loss =     -429.940, Turn_over =   0.50, TE = 0.028, Industry_dev = 0.010, FE_BP = 0.994, FE_return = 0.430
Step 1700, Loss =     -430.520, Turn_over =   0.50, TE = 0.028, Industry_dev = 0.010, FE_BP = 0.994, FE_return = 0.431
Step 1800, Loss =     -431.107, Turn_over =   0.50, TE = 0.028, Industry_dev = 0.010, FE_BP = 0.993, FE_return = 0.431
Step 1900, Loss =     -431.686, Turn_over =   0.50, TE = 0.028, Industry_dev = 0.010, FE_BP = 0.993, FE_return = 0.432
           final_weight  initial_weight  industry        BP  return_1m
600657.SH      0.010327        0.004542       8.0  3.340415   0.433913
603377.SH      0.011509        0.004317      10.0 -0.688340   1.322999
600325.SH      0.013452        0.014615       8.0  4.593034   0.508441
000543.SZ      0.005376        0.006521      19.0  5.173019   0.409861
600426.SH      0.006593        0.014345      15.0  0.732370   1.027588
600642.SH      0.013182        0.018168      19.0  3.795891   0.513837
000536.SZ      0.016240        0.003598       4.0  2.254050  -0.115833
000656.SZ      0.013821        0.014795       8.0  2.169025   0.663545
600839.SH      0.009435        0.014795       6.0  4.129258   0.187507
000028.SZ      0.012290        0.012547       2.0 -0.022092   1.004855
002407.SZ      0.014296        0.016054      15.0 -0.470598   1.234429
000581.SZ      0.012626        0.013671      10.0  1.039758   0.623095
600528.SH      0.012853        0.013761      18.0  0.539422   0.766963
603569.SH      0.009270        0.001439      10.0 -0.690009   0.140229
600628.SH      0.004227        0.004992       1.0  1.019937   0.681106
000488.SZ      0.010172        0.015740       3.0  1.983297   0.449626
000066.SZ      0.019215        0.017179      21.0 -0.100767   1.069245
600335.SH      0.003157        0.004317      10.0  1.156768   0.250614
601168.SH      0.018704        0.017493      11.0  1.476089   0.666432
002078.SZ      0.010471        0.013491       3.0  0.489191   0.487933
000572.SZ      0.009028        0.006431      10.0  3.858625   0.213837
600266.SH      0.005412        0.014390       8.0  2.552822  -0.005214
002344.SZ      0.003213        0.004587       1.0  1.681014   0.130608
002583.SZ      0.015546        0.011602       0.0 -0.580945   0.996496
601811.SH      0.009176        0.001619       5.0  0.699518   0.313548
601000.SH      0.012069        0.013671      14.0  1.287883   0.064992
603169.SH      0.005371        0.003688      13.0 -0.228621   0.047736
002179.SZ      0.011535        0.014840      26.0 -0.589621   0.741253
002277.SZ      0.009840        0.004947       1.0  1.489452   0.262322
600195.SH      0.003941        0.004317      20.0  0.727593   0.113193
...                 ...             ...       ...       ...        ...
600880.SH      0.010975        0.005306       5.0  1.041440   0.034877
600017.SH      0.007915        0.009129      14.0  2.358369   0.473624
600058.SH      0.006588        0.006431      17.0  0.141348   0.606968
000960.SZ      0.012743        0.011063      11.0  0.546798   0.656699
600079.SH      0.017954        0.018303       2.0  0.904334   0.219244
600694.SH      0.008974        0.007600       1.0  1.424400   0.465065
002050.SZ      0.009888        0.016009       6.0 -0.571582   0.394762
600586.SH      0.009251        0.005756       7.0  1.066505   0.131444
600978.SH      0.012202        0.013221      20.0  0.780493  -0.447053
600220.SH      0.009503        0.005306       9.0  0.223166   0.158057
000563.SZ      0.009140        0.009174      28.0  0.593055   0.837275
600240.SH      0.009943        0.011153       8.0  0.787934   0.505934
000620.SZ      0.004227        0.005756       8.0  1.106325   0.077884
600801.SH      0.005052        0.006521       7.0  1.282396   0.217362
300156.SZ      0.013704        0.016009      19.0 -0.879740   0.337195
002038.SZ      0.015065        0.011917       2.0 -0.392099   0.217317
002709.SZ      0.007207        0.007915      15.0 -0.831070   0.997540
002325.SZ      0.004980        0.006251      18.0  0.609325   0.316066
601699.SH      0.010976        0.013086      24.0  1.301371  -0.445034
600122.SH      0.009182        0.010298       1.0  1.842435   0.529416
002358.SZ      0.012617        0.006251      22.0  0.011226   0.433358
002051.SZ      0.009441        0.010253      18.0  0.076174   0.848977
600216.SH      0.009264        0.006566       2.0  1.784738   0.050238
600751.SH      0.008580        0.009444      14.0  2.658980   0.263696
600187.SH      0.005509        0.006611      19.0  0.717448   0.337195
600380.SH      0.010777        0.007735       2.0  1.645410   0.277482
600759.SH      0.008761        0.005936      12.0  0.725381   0.182882
000400.SZ      0.010421        0.011018      22.0  0.593648   0.478740
600500.SH      0.007224        0.011692      15.0  2.697629   0.164562
002233.SZ      0.009279        0.005531       7.0  0.367315   0.120715

[100 rows x 5 columns]
This month excess return: -0.0056922947987914085
20170926
Start Training:
First Optimization Finished!
Start Training:
Step 0   , Loss =    20464.436, Turn_over =   0.69, TE = 0.036, Industry_dev = 0.022, FE_BP = 1.899, FE_return = 0.346
Step 100 , Loss =      821.104, Turn_over =   0.49, TE = 0.047, Industry_dev = 0.021, FE_BP = 1.782, FE_return = 0.382
Step 200 , Loss =      629.868, Turn_over =   0.50, TE = 0.046, Industry_dev = 0.020, FE_BP = 1.779, FE_return = 0.382
Step 300 , Loss =      578.706, Turn_over =   0.49, TE = 0.046, Industry_dev = 0.020, FE_BP = 1.779, FE_return = 0.383
Step 400 , Loss =      528.824, Turn_over =   0.49, TE = 0.045, Industry_dev = 0.019, FE_BP = 1.778, FE_return = 0.385
Step 500 , Loss =      479.386, Turn_over =   0.49, TE = 0.045, Industry_dev = 0.019, FE_BP = 1.778, FE_return = 0.386
Step 600 , Loss =      430.382, Turn_over =   0.48, TE = 0.045, Industry_dev = 0.018, FE_BP = 1.778, FE_return = 0.388
Step 700 , Loss =      367.181, Turn_over =   0.50, TE = 0.045, Industry_dev = 0.018, FE_BP = 1.774, FE_return = 0.389
Step 800 , Loss =      317.685, Turn_over =   0.50, TE = 0.044, Industry_dev = 0.017, FE_BP = 1.774, FE_return = 0.391
Step 900 , Loss =      268.147, Turn_over =   0.49, TE = 0.044, Industry_dev = 0.017, FE_BP = 1.773, FE_return = 0.392
Step 1000, Loss =      218.503, Turn_over =   0.49, TE = 0.044, Industry_dev = 0.016, FE_BP = 1.773, FE_return = 0.394
Step 1100, Loss =      169.565, Turn_over =   0.49, TE = 0.044, Industry_dev = 0.016, FE_BP = 1.773, FE_return = 0.396
Step 1200, Loss =      122.939, Turn_over =   0.49, TE = 0.043, Industry_dev = 0.015, FE_BP = 1.773, FE_return = 0.397
Step 1300, Loss =       76.345, Turn_over =   0.49, TE = 0.043, Industry_dev = 0.015, FE_BP = 1.773, FE_return = 0.399
Step 1400, Loss =       30.204, Turn_over =   0.49, TE = 0.043, Industry_dev = 0.014, FE_BP = 1.773, FE_return = 0.400
Step 1500, Loss =      -16.476, Turn_over =   0.49, TE = 0.043, Industry_dev = 0.014, FE_BP = 1.774, FE_return = 0.402
Step 1600, Loss =      -63.946, Turn_over =   0.49, TE = 0.043, Industry_dev = 0.013, FE_BP = 1.774, FE_return = 0.404
Step 1700, Loss =     -112.086, Turn_over =   0.49, TE = 0.043, Industry_dev = 0.013, FE_BP = 1.774, FE_return = 0.406
Step 1800, Loss =     -155.495, Turn_over =   0.49, TE = 0.042, Industry_dev = 0.013, FE_BP = 1.772, FE_return = 0.408
Step 1900, Loss =     -200.000, Turn_over =   0.50, TE = 0.042, Industry_dev = 0.012, FE_BP = 1.771, FE_return = 0.409
           final_weight  initial_weight  industry        BP  return_1m
000727.SZ      0.016617        0.008330       4.0  4.903409   0.380105
600325.SH      0.011116        0.014520       8.0  4.876627   0.333764
600839.SH      0.014481        0.014520       6.0  4.294618   0.510242
000572.SZ      0.007277        0.006190      10.0  3.740420   0.130027
600642.SH      0.012229        0.018116      19.0  3.942312   0.422891
600755.SH      0.013892        0.015112       1.0  3.541035   1.367803
600805.SH      0.009601        0.005644      25.0  3.337312   0.166282
600291.SH      0.010500        0.022349      28.0  2.823491   0.964339
600126.SH      0.007914        0.003277      17.0  2.286587   0.751962
600500.SH      0.007005        0.012335      15.0  3.062739   0.630088
600098.SH      0.007413        0.006554      19.0  2.796796   0.344568
000027.SZ      0.008044        0.008466      19.0  2.911541   0.296871
600219.SH      0.013480        0.023987      11.0  2.670831   0.070602
600881.SH      0.008616        0.009331       7.0  2.938473  -0.019842
000926.SZ      0.008913        0.010241       8.0  2.944263  -0.079858
000528.SZ      0.011455        0.007783      13.0  2.685181   0.307769
600166.SH      0.012979        0.014656      10.0  2.905356   0.087763
601001.SH      0.004706        0.006827      24.0  2.716783  -0.441207
002005.SZ      0.008405        0.005007       4.0  2.383245   0.014491
600277.SH      0.006857        0.006919      15.0  2.180433   1.073645
600582.SH      0.013726        0.008967      13.0  2.689011  -0.191028
600808.SH      0.004881        0.017114      17.0  1.739379   0.951438
000778.SZ      0.013853        0.014793      17.0  2.269356   1.030046
600859.SH      0.007194        0.005416       1.0  2.183386  -0.070343
000825.SZ      0.011998        0.013518      17.0  2.299809   0.558889
600022.SH      0.009572        0.017524      17.0  2.481572   0.214167
600466.SH      0.007371        0.008694       8.0  2.336429   0.067511
600266.SH      0.013011        0.014611       8.0  2.415930   0.125080
000543.SZ      0.005679        0.006600      19.0  4.835707   0.219180
600284.SH      0.005775        0.006554      18.0  1.985491   0.459675
...                 ...             ...       ...       ...        ...
601678.SH      0.009315        0.009422      15.0  1.019585   1.423158
600409.SH      0.013090        0.014383      15.0  0.476028   0.990416
600006.SH      0.004219        0.005098      10.0  1.205316  -0.096403
000979.SZ      0.009085        0.010560       8.0  1.411246   0.228240
600587.SH      0.016341        0.006281       2.0  1.135869   0.389938
600528.SH      0.005740        0.014019      18.0  0.604162   0.328252
600380.SH      0.015395        0.008147       2.0  1.456610  -0.247577
002416.SZ      0.008723        0.003778       0.0  0.756444   0.368567
600138.SH      0.006626        0.013018      23.0  0.670340   0.010846
002477.SZ      0.013232        0.009513      20.0  1.165294   0.535280
601000.SH      0.006718        0.013427      14.0  1.541238   1.118934
300134.SZ      0.017739        0.009695       0.0  0.454027   2.177113
600600.SH      0.017756        0.012062      16.0  0.491408   0.553280
600835.SH      0.010788        0.006919      13.0  1.108173   0.252146
000028.SZ      0.018065        0.011152       2.0  0.041206   1.060296
600699.SH      0.005604        0.013382      10.0  0.640446  -0.317805
002375.SZ      0.006049        0.007783      18.0  1.309981  -0.265920
601233.SH      0.009134        0.006054      12.0  1.188045  -0.276441
000690.SZ      0.005642        0.013018      19.0  0.838677  -0.422213
600751.SH      0.008424        0.008694      14.0  3.004974   0.937553
000939.SZ      0.006799        0.008921      19.0  1.318817  -0.272881
002004.SZ      0.007262        0.012107      15.0  1.671524   0.427547
600270.SH      0.007308        0.007374      14.0  0.726604   1.169556
002123.SZ      0.011733        0.006236      -1.0  1.013537   0.075871
000830.SZ      0.008627        0.011015      15.0  1.400569  -0.411071
000025.SZ      0.002416        0.002731      10.0 -1.069195   0.640714
002663.SZ      0.008373        0.005325      18.0  0.781642   0.377220
002106.SZ      0.016642        0.006782       4.0  0.870707   0.505435
000636.SZ      0.016894        0.007283       4.0  0.987137   0.273817
000960.SZ      0.016473        0.011880      11.0  0.334797   0.034296

[100 rows x 5 columns]
This month excess return: -0.01758391596376896
20171031
Start Training:
First Optimization Finished!
Start Training:
Step 0   , Loss =    26424.592, Turn_over =   0.74, TE = 0.072, Industry_dev = 0.025, FE_BP = 1.638, FE_return = 0.288
Step 100 , Loss =     1127.918, Turn_over =   0.50, TE = 0.082, Industry_dev = 0.021, FE_BP = 1.606, FE_return = 0.322
Step 200 , Loss =      757.537, Turn_over =   0.49, TE = 0.080, Industry_dev = 0.020, FE_BP = 1.608, FE_return = 0.318
Step 300 , Loss =      608.670, Turn_over =   0.50, TE = 0.079, Industry_dev = 0.019, FE_BP = 1.604, FE_return = 0.321
Step 400 , Loss =      542.574, Turn_over =   0.50, TE = 0.079, Industry_dev = 0.019, FE_BP = 1.599, FE_return = 0.326
Step 500 , Loss =      479.958, Turn_over =   0.49, TE = 0.078, Industry_dev = 0.018, FE_BP = 1.598, FE_return = 0.332
Step 600 , Loss =      420.602, Turn_over =   0.49, TE = 0.078, Industry_dev = 0.018, FE_BP = 1.594, FE_return = 0.337
Step 700 , Loss =      369.586, Turn_over =   0.50, TE = 0.077, Industry_dev = 0.017, FE_BP = 1.591, FE_return = 0.341
Step 800 , Loss =      324.781, Turn_over =   0.49, TE = 0.077, Industry_dev = 0.017, FE_BP = 1.592, FE_return = 0.345
Step 900 , Loss =      273.656, Turn_over =   0.49, TE = 0.076, Industry_dev = 0.016, FE_BP = 1.589, FE_return = 0.350
Step 1000, Loss =      223.074, Turn_over =   0.50, TE = 0.076, Industry_dev = 0.016, FE_BP = 1.585, FE_return = 0.354
Step 1100, Loss =      180.602, Turn_over =   0.49, TE = 0.076, Industry_dev = 0.015, FE_BP = 1.585, FE_return = 0.358
Step 1200, Loss =      129.978, Turn_over =   0.50, TE = 0.075, Industry_dev = 0.015, FE_BP = 1.582, FE_return = 0.363
Step 1300, Loss =       88.635, Turn_over =   0.49, TE = 0.075, Industry_dev = 0.015, FE_BP = 1.581, FE_return = 0.367
Step 1400, Loss =       41.213, Turn_over =   0.50, TE = 0.075, Industry_dev = 0.014, FE_BP = 1.578, FE_return = 0.372
Step 1500, Loss =        2.698, Turn_over =   0.49, TE = 0.075, Industry_dev = 0.014, FE_BP = 1.578, FE_return = 0.376
Step 1600, Loss =      -35.695, Turn_over =   0.49, TE = 0.074, Industry_dev = 0.013, FE_BP = 1.577, FE_return = 0.380
Step 1700, Loss =      -85.536, Turn_over =   0.50, TE = 0.074, Industry_dev = 0.013, FE_BP = 1.574, FE_return = 0.385
Step 1800, Loss =     -124.977, Turn_over =   0.49, TE = 0.074, Industry_dev = 0.013, FE_BP = 1.573, FE_return = 0.390
Step 1900, Loss =     -161.994, Turn_over =   0.48, TE = 0.073, Industry_dev = 0.012, FE_BP = 1.573, FE_return = 0.394
           final_weight  initial_weight  industry        BP  return_1m
600325.SH      0.008705        0.013885       8.0  5.087284   0.376979
000543.SZ      0.011450        0.006345      19.0  4.704453  -0.016189
000727.SZ      0.018686        0.008184       4.0  4.473682  -0.329824
000761.SZ      0.005680        0.001931      17.0  2.409922   0.940424
000732.SZ      0.007872        0.009379       8.0  3.809615   0.004130
600642.SH      0.014727        0.017379      19.0  3.911083  -0.009224
600839.SH      0.015033        0.013839       6.0  3.726342  -0.513887
600717.SH      0.006719        0.010529      14.0  3.211487   0.066370
600219.SH      0.012867        0.023678      11.0  2.671984   0.064786
600098.SH      0.006509        0.006391      19.0  2.823857   0.213928
600881.SH      0.008038        0.009609       7.0  3.006617   0.057853
000926.SZ      0.008372        0.010069       8.0  2.818421   0.068352
000027.SZ      0.010981        0.008184      19.0  2.801885  -0.015621
601717.SH      0.007612        0.007448      13.0  2.591417   0.401303
600751.SH      0.006689        0.008368      14.0  2.789249  -0.023053
600551.SH      0.011979        0.003080       5.0  1.941846   0.504731
600277.SH      0.005357        0.006069      15.0  2.359524   0.363360
600291.SH      0.009258        0.018713      28.0  2.633357   0.324119
600017.SH      0.007803        0.008322      14.0  2.507681   0.085530
600022.SH      0.007269        0.017333      17.0  2.622032   0.157521
600166.SH      0.003697        0.015448      10.0  2.660025  -0.155946
000528.SZ      0.009028        0.007494      13.0  2.413548  -0.167688
000778.SZ      0.012187        0.013471      17.0  2.336989   0.361196
000488.SZ      0.009732        0.018667       3.0  1.869211  -0.168199
601168.SH      0.014027        0.018805      11.0  1.510408   0.776467
000656.SZ      0.012906        0.014115       8.0  2.247076   0.306311
600266.SH      0.012171        0.015632       8.0  2.358768  -0.327181
600418.SH      0.010497        0.011402      10.0  2.023677   0.344854
600894.SH      0.005262        0.005241      13.0  1.812381   0.227436
600808.SH      0.008964        0.014667      17.0  2.007627   0.388628
...                 ...             ...       ...       ...        ...
603569.SH      0.009764        0.001471      10.0 -0.706893  -0.251668
000401.SZ      0.010426        0.011770       7.0  1.041703   0.710565
000878.SZ      0.013768        0.013241      11.0  0.307488   0.178606
600125.SH      0.008820        0.011632      14.0  0.186182   0.705561
000581.SZ      0.004931        0.013103      10.0  1.030534  -0.361521
600831.SH      0.003585        0.003862       5.0  0.738741   0.258668
600240.SH      0.005654        0.012414       8.0  0.577082   0.209414
002392.SZ      0.009774        0.004644       7.0  0.495390   1.140779
000519.SZ      0.010519        0.006713      26.0  0.864597   0.640544
600143.SH      0.009354        0.010713      15.0  1.211327   0.011212
600720.SH      0.005311        0.007034       7.0  1.355542  -0.729719
600770.SH      0.012262        0.006943      25.0  0.859329   0.539121
002123.SZ      0.014668        0.006989      -1.0  0.967165   0.204125
000825.SZ      0.009439        0.012276      17.0  2.334429  -0.020426
300002.SZ      0.020357        0.011080      21.0  0.161533   0.681090
600307.SH      0.004374        0.011908      17.0  0.764197   0.137534
000762.SZ      0.013964        0.008874      11.0 -0.178696   1.925384
600079.SH      0.022111        0.017425       2.0  0.710517  -0.564717
600026.SH      0.007435        0.009287      14.0  3.084149  -0.141591
002400.SZ      0.007645        0.009057       5.0  0.804862   0.753528
000547.SZ      0.006585        0.012782      26.0  0.122992   0.112389
300291.SZ      0.010958        0.007770       5.0  1.099287   2.487651
002128.SZ      0.008471        0.009195      24.0  0.903890   0.412598
002078.SZ      0.011073        0.016276       3.0  0.378141   0.019965
002249.SZ      0.008952        0.008644      13.0  0.817942   0.558099
600458.SH      0.009444        0.005655      13.0  0.935271  -0.236917
002477.SZ      0.018402        0.008828      20.0  1.013561   0.020379
000400.SZ      0.019279        0.010483      22.0  0.739059   0.726512
000025.SZ      0.004066        0.002483      10.0 -1.118878  -0.085669
600187.SH      0.006317        0.006345      19.0  0.784609   0.262315

[100 rows x 5 columns]
This month excess return: 0.0015503671020269394
20171128
Start Training:
First Optimization Finished!
Start Training:
Step 0   , Loss =    13382.926, Turn_over =   0.60, TE = 0.072, Industry_dev = 0.023, FE_BP = 1.632, FE_return = 0.083
Step 100 , Loss =     1974.922, Turn_over =   0.50, TE = 0.064, Industry_dev = 0.023, FE_BP = 1.508, FE_return = 0.128
Step 200 , Loss =     1777.840, Turn_over =   0.50, TE = 0.064, Industry_dev = 0.022, FE_BP = 1.509, FE_return = 0.127
Step 300 , Loss =     1610.615, Turn_over =   0.49, TE = 0.063, Industry_dev = 0.022, FE_BP = 1.511, FE_return = 0.125
Step 400 , Loss =     1432.104, Turn_over =   0.49, TE = 0.062, Industry_dev = 0.021, FE_BP = 1.512, FE_return = 0.125
Step 500 , Loss =     1261.425, Turn_over =   0.49, TE = 0.062, Industry_dev = 0.021, FE_BP = 1.513, FE_return = 0.124
Step 600 , Loss =     1097.629, Turn_over =   0.50, TE = 0.061, Industry_dev = 0.020, FE_BP = 1.514, FE_return = 0.122
Step 700 , Loss =      938.427, Turn_over =   0.50, TE = 0.061, Industry_dev = 0.020, FE_BP = 1.514, FE_return = 0.121
Step 800 , Loss =      794.930, Turn_over =   0.50, TE = 0.060, Industry_dev = 0.019, FE_BP = 1.516, FE_return = 0.120
Step 900 , Loss =      756.019, Turn_over =   0.49, TE = 0.060, Industry_dev = 0.019, FE_BP = 1.515, FE_return = 0.120
Step 1000, Loss =      712.445, Turn_over =   0.50, TE = 0.060, Industry_dev = 0.018, FE_BP = 1.512, FE_return = 0.121
Step 1100, Loss =      674.759, Turn_over =   0.49, TE = 0.060, Industry_dev = 0.018, FE_BP = 1.512, FE_return = 0.122
Step 1200, Loss =      638.176, Turn_over =   0.49, TE = 0.060, Industry_dev = 0.018, FE_BP = 1.512, FE_return = 0.122
Step 1300, Loss =      594.053, Turn_over =   0.50, TE = 0.060, Industry_dev = 0.017, FE_BP = 1.509, FE_return = 0.123
Step 1400, Loss =      557.580, Turn_over =   0.50, TE = 0.060, Industry_dev = 0.017, FE_BP = 1.508, FE_return = 0.124
Step 1500, Loss =      521.449, Turn_over =   0.49, TE = 0.060, Industry_dev = 0.016, FE_BP = 1.508, FE_return = 0.124
Step 1600, Loss =      485.212, Turn_over =   0.49, TE = 0.060, Industry_dev = 0.016, FE_BP = 1.508, FE_return = 0.124
Step 1700, Loss =      443.814, Turn_over =   0.50, TE = 0.060, Industry_dev = 0.016, FE_BP = 1.504, FE_return = 0.125
Step 1800, Loss =      410.078, Turn_over =   0.50, TE = 0.060, Industry_dev = 0.015, FE_BP = 1.504, FE_return = 0.126
Step 1900, Loss =      376.463, Turn_over =   0.49, TE = 0.060, Industry_dev = 0.015, FE_BP = 1.503, FE_return = 0.126
           final_weight  initial_weight  industry        BP  return_1m
000543.SZ      0.007918        0.006605      19.0  5.106680   0.018732
600325.SH      0.013076        0.014025       8.0  4.697092  -0.249019
000732.SZ      0.008886        0.009812       8.0  3.843772  -0.378748
600642.SH      0.017282        0.017997      19.0  3.798999  -0.210588
600839.SH      0.014457        0.015365       6.0  3.601904  -0.144829
600500.SH      0.007789        0.011775      15.0  3.254431   0.195379
601001.SH      0.004822        0.005887      24.0  3.070570   0.080096
600755.SH      0.012988        0.014982       1.0  3.294026   0.060985
600219.SH      0.014830        0.024076      11.0  2.658074  -0.181125
000727.SZ      0.012237        0.008664       4.0  4.961778   0.461930
600291.SH      0.008793        0.019673      28.0  3.044924  -0.411298
000937.SZ      0.005519        0.007276      24.0  2.663635  -0.095953
600277.SH      0.005627        0.006079      15.0  2.541324  -0.038851
600582.SH      0.011908        0.008951      13.0  2.602817  -0.035949
600166.SH      0.007503        0.015843      10.0  2.610710  -0.019177
002807.SZ      0.003630        0.002154      27.0  1.260561   0.992879
600022.SH      0.010514        0.016896      17.0  2.588958  -0.161858
000600.SZ      0.009204        0.007850      19.0  1.976000   1.041504
600881.SH      0.011697        0.009573       7.0  2.588223  -0.622894
600039.SH      0.007782        0.008903      18.0  2.252694   0.122152
600348.SH      0.005662        0.009812      24.0  2.327106  -0.098660
600894.SH      0.007394        0.005265      13.0  1.938496   0.286773
000488.SZ      0.010949        0.017854       3.0  2.049331   0.081662
601168.SH      0.014957        0.017423      11.0  1.565495   0.239972
000552.SZ      0.005589        0.005696      24.0  2.014258   0.001288
600418.SH      0.010143        0.010626      10.0  2.071679   0.281600
600266.SH      0.014386        0.015700       8.0  2.251010  -0.019039
600428.SH      0.005628        0.006318      14.0  1.729456   0.574889
600611.SH      0.008620        0.007658      14.0  1.907038   0.075763
600122.SH      0.009948        0.010387       1.0  1.997580  -0.040374
...                 ...             ...       ...       ...        ...
603569.SH      0.013692        0.001580      10.0 -0.612690   1.654863
600600.SH      0.019090        0.013450      16.0  0.312009  -0.323936
000999.SZ      0.017854        0.012349       2.0  0.114595   0.383751
002309.SZ      0.014893        0.005074       0.0  1.187350  -0.634407
002601.SZ      0.010527        0.012062      15.0  0.304180   0.437294
000050.SZ      0.013072        0.023741       4.0  0.474335   0.365472
002249.SZ      0.010937        0.008185      13.0  0.923166   0.467967
600143.SH      0.010139        0.010913      15.0  1.182595  -0.059816
300122.SZ      0.015541        0.015365       2.0 -1.209948  -0.393922
600094.SH      0.009419        0.009621       8.0  1.204552  -0.256851
002004.SZ      0.009726        0.012158      15.0  1.660148   0.199222
601678.SH      0.007764        0.009286      15.0  1.014048   0.217243
600808.SH      0.007205        0.013977      17.0  1.665596  -0.615723
000099.SZ      0.005115        0.005361      14.0  0.704825   0.538234
000979.SZ      0.009700        0.010961       8.0  1.286415  -0.550371
600240.SH      0.011367        0.012110       8.0  0.597183   0.101623
600635.SH      0.012890        0.010961      19.0  1.046194   0.160021
000028.SZ      0.017230        0.011200       2.0  0.100818   0.631117
603025.SH      0.011214        0.001819      21.0 -0.964877  -0.617396
000025.SZ      0.008436        0.002680      10.0 -1.134890   0.078891
600848.SH      0.008066        0.011727       8.0 -0.372284   0.753899
000860.SZ      0.015675        0.008855      16.0  1.128101  -0.231482
002048.SZ      0.012403        0.012397      10.0  0.593777  -0.225139
603877.SH      0.004947        0.001867       9.0 -0.442722   1.046979
601699.SH      0.004309        0.012541      24.0  1.282556  -0.713790
600729.SH      0.009427        0.007276       1.0  0.700846   0.641511
600125.SH      0.006642        0.011392      14.0  0.199622   0.341770
000970.SZ      0.016926        0.015173       4.0 -0.118704   0.714165
002482.SZ      0.006126        0.006510      18.0  0.714704   0.493441
600422.SH      0.015344        0.006558       2.0  0.602512   0.754978

[100 rows x 5 columns]
This month excess return: 0.0037707812152802944
TE: 0.04453789772386302, EX: -0.11057747481390834IR: -2.482772660252033
